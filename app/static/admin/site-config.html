<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Site Configuration | Admin Dashboard</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#3B82F6',
                        secondary: '#10B981',
                    }
                }
            }
        }
    </script>
</head>
<body class="flex flex-col min-h-screen bg-gray-100">
    <div id="header-container"></div>

    <main class="flex-grow p-6">
        <div class="max-w-7xl mx-auto">
            <!-- Site Configuration Section -->
            <div class="bg-white rounded-lg shadow-md p-6 mb-6">
                <h2 class="text-2xl font-semibold mb-4">Site Configuration</h2>
                
                <form id="site-config-form" class="space-y-6">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <!-- Contact Information -->
                        <div class="bg-gray-50 p-4 rounded-md">
                            <h3 class="font-medium text-lg mb-3">Contact Information</h3>
                            
                            <div class="space-y-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Name</label>
                                    <input type="text" id="name" class="w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Title</label>
                                    <input type="text" id="title" class="w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Email</label>
                                    <input type="email" id="email" class="w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Phone</label>
                                    <input type="text" id="phone" class="w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Location</label>
                                    <input type="text" id="location" class="w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                </div>
                            </div>
                        </div>
                        
                        <!-- Social Media Links -->
                        <div class="bg-gray-50 p-4 rounded-md">
                            <h3 class="font-medium text-lg mb-3">Social Media</h3>
                            
                            <div class="space-y-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">LinkedIn URL</label>
                                    <input type="url" id="linkedin" class="w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">GitHub URL</label>
                                    <input type="url" id="github" class="w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Twitter URL</label>
                                    <input type="url" id="twitter" class="w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Instagram URL</label>
                                    <input type="url" id="instagram" class="w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Facebook URL</label>
                                    <input type="url" id="facebook" class="w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- About Me Section -->
                    <div class="bg-gray-50 p-4 rounded-md">
                        <h3 class="font-medium text-lg mb-3">About Me</h3>
                        
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Short Bio (one-liner)</label>
                                <input type="text" id="short-bio" class="w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Long Bio</label>
                                <textarea id="long-bio" rows="5" class="w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"></textarea>
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Resume URL</label>
                                <input type="url" id="resume-url" class="w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Profile Image URL</label>
                                <input type="url" id="profile-image" class="w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                            </div>
                        </div>
                    </div>
                    
                    <!-- Site Settings -->
                    <div class="bg-gray-50 p-4 rounded-md">
                        <h3 class="font-medium text-lg mb-3">Site Settings</h3>
                        
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Site Title</label>
                                <input type="text" id="site-title" class="w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Meta Description</label>
                                <textarea id="meta-description" rows="2" class="w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"></textarea>
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Keywords (comma separated)</label>
                                <input type="text" id="keywords" class="w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Favicon URL</label>
                                <input type="url" id="favicon-url" class="w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                            </div>
                            
                            <div class="flex items-center">
                                <input type="checkbox" id="enable-dark-mode" class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded">
                                <label for="enable-dark-mode" class="ml-2 block text-sm text-gray-700">Enable Dark Mode Option</label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="flex justify-end">
                        <button type="submit" id="save-config-btn" class="px-6 py-2 bg-green-500 text-white font-medium rounded-md hover:bg-green-600 transition-colors">
                            <i class="fas fa-save mr-2"></i>Save Configuration
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </main>

    <div id="footer-container"></div>

    <!-- Loading overlay -->
    <div id="loading-overlay" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white p-6 rounded-lg shadow-lg">
            <div class="flex items-center">
                <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500 mr-3"></div>
                <p>Loading...</p>
            </div>
        </div>
    </div>

    <!-- Notification -->
    <div id="notification" class="fixed top-4 right-4 p-4 rounded-md shadow-md transform transition-transform duration-300 translate-x-full z-50">
        <div class="flex items-center">
            <i id="notification-icon" class="fas mr-2"></i>
            <p id="notification-message"></p>
        </div>
    </div>

    <script src="js/admin-utils.js"></script>
    <script>
        // Load header and footer components
        fetch('components/header.html')
            .then(response => response.text())
            .then(data => {
                document.getElementById('header-container').innerHTML = data;
                const currentPage = 'site-config'; 
                document.querySelector(`.nav-link[data-page="${currentPage}"]`).classList.add('bg-gray-200');
            });

        fetch('components/footer.html')
            .then(response => response.text())
            .then(data => {
                document.getElementById('footer-container').innerHTML = data;
            });

        // Site Config Functions
        async function loadSiteConfig() {
            showLoading(true);
            try {
                const response = await fetchFromAPI('/site-config');
                if (response && response.data) {
                    const config = response.data;
                    
                    // Contact Information
                    document.getElementById('name').value = config.name || '';
                    document.getElementById('title').value = config.title || '';
                    document.getElementById('email').value = config.email || '';
                    document.getElementById('phone').value = config.phone || '';
                    document.getElementById('location').value = config.location || '';
                    
                    // Social Media
                    document.getElementById('linkedin').value = config.social?.linkedin || '';
                    document.getElementById('github').value = config.social?.github || '';
                    document.getElementById('twitter').value = config.social?.twitter || '';
                    document.getElementById('instagram').value = config.social?.instagram || '';
                    document.getElementById('facebook').value = config.social?.facebook || '';
                    
                    // About Me
                    document.getElementById('short-bio').value = config.shortBio || '';
                    document.getElementById('long-bio').value = config.longBio || '';
                    document.getElementById('resume-url').value = config.resumeUrl || '';
                    document.getElementById('profile-image').value = config.profileImage || '';
                    
                    // Site Settings
                    document.getElementById('site-title').value = config.siteTitle || '';
                    document.getElementById('meta-description').value = config.metaDescription || '';
                    document.getElementById('keywords').value = config.keywords?.join(', ') || '';
                    document.getElementById('favicon-url').value = config.faviconUrl || '';
                    document.getElementById('enable-dark-mode').checked = config.enableDarkMode || false;
                }
            } catch (error) {
                console.error('Error loading site configuration:', error);
                showNotification('Failed to load site configuration', 'error');
                
                // Load local JSON data as fallback
                try {
                    const localResponse = await fetch('../js/site-config.json');
                    if (localResponse.ok) {
                        const config = await localResponse.json();
                        
                        // Contact Information
                        document.getElementById('name').value = config.name || '';
                        document.getElementById('title').value = config.title || '';
                        document.getElementById('email').value = config.email || '';
                        document.getElementById('phone').value = config.phone || '';
                        document.getElementById('location').value = config.location || '';
                        
                        // Social Media
                        document.getElementById('linkedin').value = config.social?.linkedin || '';
                        document.getElementById('github').value = config.social?.github || '';
                        document.getElementById('twitter').value = config.social?.twitter || '';
                        document.getElementById('instagram').value = config.social?.instagram || '';
                        document.getElementById('facebook').value = config.social?.facebook || '';
                        
                        // About Me
                        document.getElementById('short-bio').value = config.shortBio || '';
                        document.getElementById('long-bio').value = config.longBio || '';
                        document.getElementById('resume-url').value = config.resumeUrl || '';
                        document.getElementById('profile-image').value = config.profileImage || '';
                        
                        // Site Settings
                        document.getElementById('site-title').value = config.siteTitle || '';
                        document.getElementById('meta-description').value = config.metaDescription || '';
                        document.getElementById('keywords').value = config.keywords?.join(', ') || '';
                        document.getElementById('favicon-url').value = config.faviconUrl || '';
                        document.getElementById('enable-dark-mode').checked = config.enableDarkMode || false;
                    }
                } catch (localError) {
                    console.error('Error loading local site configuration:', localError);
                }
            } finally {
                showLoading(false);
            }
        }

        async function saveSiteConfig(event) {
            event.preventDefault();
            
            const configData = {
                // Contact Information
                name: document.getElementById('name').value.trim(),
                title: document.getElementById('title').value.trim(),
                email: document.getElementById('email').value.trim(),
                phone: document.getElementById('phone').value.trim(),
                location: document.getElementById('location').value.trim(),
                
                // Social Media
                social: {
                    linkedin: document.getElementById('linkedin').value.trim(),
                    github: document.getElementById('github').value.trim(),
                    twitter: document.getElementById('twitter').value.trim(),
                    instagram: document.getElementById('instagram').value.trim(),
                    facebook: document.getElementById('facebook').value.trim()
                },
                
                // About Me
                shortBio: document.getElementById('short-bio').value.trim(),
                longBio: document.getElementById('long-bio').value.trim(),
                resumeUrl: document.getElementById('resume-url').value.trim(),
                profileImage: document.getElementById('profile-image').value.trim(),
                
                // Site Settings
                siteTitle: document.getElementById('site-title').value.trim(),
                metaDescription: document.getElementById('meta-description').value.trim(),
                keywords: document.getElementById('keywords').value.split(',').map(k => k.trim()).filter(k => k),
                faviconUrl: document.getElementById('favicon-url').value.trim(),
                enableDarkMode: document.getElementById('enable-dark-mode').checked
            };
            
            // Validate required fields
            let hasError = false;
            const requiredFields = ['name', 'email', 'title', 'short-bio', 'site-title'];
            
            requiredFields.forEach(fieldId => {
                const field = document.getElementById(fieldId);
                if (!field.value.trim()) {
                    field.classList.add('border-red-500');
                    hasError = true;
                }
            });
            
            if (hasError) {
                showNotification('Please fill in all required fields', 'error');
                return;
            }
            
            showLoading(true);
            try {
                const response = await fetchFromAPI('/site-config', {
                    method: 'POST',
                    body: JSON.stringify(configData)
                });
                
                if (response && response.success) {
                    showNotification('Site configuration saved successfully');
                } else {
                    throw new Error('Failed to save site configuration');
                }
            } catch (error) {
                console.error('Error saving site configuration:', error);
                showNotification('Failed to save site configuration', 'error');
            } finally {
                showLoading(false);
            }
        }

        function initSiteConfigPage() {
            // Load site configuration
            loadSiteConfig();
            
            // Form submission
            document.getElementById('site-config-form').addEventListener('submit', saveSiteConfig);
            
            // Remove error indicator when user starts typing
            document.addEventListener('input', function(event) {
                if (event.target.tagName === 'INPUT' || event.target.tagName === 'TEXTAREA') {
                    event.target.classList.remove('border-red-500');
                }
            });
        }

        // Initialize page
        initPage(initSiteConfigPage);
    </script>
</body>
</html> 